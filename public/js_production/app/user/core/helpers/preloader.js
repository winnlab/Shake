define(["canjs","underscore"],function(e,t){return e.Map.extend({namespace:"preloader",loaded:0,init:function(){this.loadImages()},loadImages:function(){this.folder=this.folder||"/uploads/",this.images.length?t.each(this.images,e.proxy(function(e){e?this.loadImage(this.folder+e):this.loaded+=1},this)):this.callback&&this.callback()},loadImage:function(e){var t=new Image;$(t).on("load."+this.namespace+" error."+this.namespace,this.imageIsLoaded.bind(this)),t.src=e},imageIsLoaded:function(){this.loaded+=1,this.loaded==this.images.length&&this.callback&&this.callback()}})});