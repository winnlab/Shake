define(["canjs","underscore","core/appState","core/helpers/preloader","managers/TitleManager","css!app/product/css/product.css"],function(e,t,n,r,i){return e.Control.extend({defaults:{viewpath:"app/product/"}},{init:function(){var t=this,s=t.getProduct(),o=t.getTitle(s.lang.name),u="productTitle"+Date.now();t.productId=s.attr("link"),t.element.html(e.view(t.options.viewpath+"index.stache",{product:s,appState:n,titleId:u})),t.titleManager=new i({bgColor:"transparent",selector:u,title:o,align:"left",letterSpacing:-4,fontSize:n.fontSize()*10.5,spaceWidth:110,lineOffset:-80,mouseRadius:50}),t.options.isReady&&new r({images:[s.img.bottle,s.img.can],callback:function(){t.options.isReady.resolve()}})},getProduct:function(){return t.find(n.products,function(t){return t.link==e.route.attr("id")})},getTitle:function(e){if(e.length<15)return e.toUpperCase();var t=e.lastIndexOf(" "),n=t?e.slice(0,t)+"\n"+e.slice(t+1):e;return n.toUpperCase()},".bottlesIcon click":function(){var e=n.attr("viewMode");n.attr("viewMode",e=="bottle"?"can":"bottle")},":module route":"controllAnimation",":module/:id route":"controllAnimation",controllAnimation:function(e){e.module==="product"&&e.id===this.productId?this.titleManager.animate.call(this.titleManager):this.titleManager.stopAnimate.call(this.titleManager)},".module.shakeIt click":function(e,t){n.attr("shakeItProduct",e.data("product"))}})});