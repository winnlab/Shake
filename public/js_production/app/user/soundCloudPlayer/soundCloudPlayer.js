define(["canjs","underscore","core/appState","soundcloud/sdk"],function(e,t,n){var r=e.Control.extend({defaults:{playlistPath:"/playlists/45428734",clientId:"36d9ee3197b18f8c51dbc9a24ef5cc70"}},{init:function(){var e=this;e.playlist=!1,e.currentTrackPosition=0,e.currentSound=null,e.displaySounds=n.attr("podcast"),e.initSoundCloudApi()},initSoundCloudApi:function(){var e=this;SC.initialize({client_id:e.options.clientId}),this.getPlaylist()},getPlaylist:function(){var e=this;SC.get(e.options.playlistPath,function(t){e.playlist=t,e.playRandomTrack(t)})},playRandomTrack:function(e){var t=this,n=Math.floor(Math.random()*(parseInt(e.track_count)-1));this.currentTrackPosition=n,t.displayTracks(n)},togglePause:function(){var e=this;e.currentSound?e.currentSound.togglePause():e.playTrack(e.currentTrackPosition)},toggleMute:function(){var e=this;e.currentSound&&e.currentSound.toggleMute()},playNextTrack:function(){this.currentSound.stop(),this.currentTrackPosition+1<=this.playlist.track_count-1?this.currentTrackPosition++:this.currentTrackPosition=0,this.playTrack(this.currentTrackPosition)},playPrevTrack:function(){this.currentSound.stop(),this.currentTrackPosition-1>=0?this.currentTrackPosition--:this.currentTrackPosition=this.playlist.track_count-1,this.playTrack(this.currentTrackPosition)},playTrack:function(e){var t=this,n="/tracks/"+t.playlist.tracks[e].id;SC.stream(n,function(n){n.play({onfinish:function(){t.playNextTrack()}}),t.currentSound=n,t.currentTrackPosition=e,t.displayTracks(e),t.displaySounds.attr("currentTitle",t.playlist.tracks[e].title)})},displayTracks:function(e){this.displaySounds.attr("currentSound",this.playlist.tracks[e]),this.displaySounds.attr("currentTrackPosition",e+1),e-1>=0?(this.displaySounds.attr("prevSound",this.playlist.tracks[e-1]),this.displaySounds.attr("prevTrackPosition",e)):(this.displaySounds.attr("prevSound",this.playlist.tracks[this.playlist.track_count-1]),this.displaySounds.attr("prevTrackPosition",this.playlist.track_count)),e+1<=this.playlist.track_count-1?(this.displaySounds.attr("nextSound",this.playlist.tracks[e+1]),this.displaySounds.attr("nextTrackPosition",e+2)):(this.displaySounds.attr("nextSound",this.playlist.tracks[0]),this.displaySounds.attr("nextTrackPosition",1))}});return new r("body")});