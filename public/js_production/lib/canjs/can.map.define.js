/*!
 * CanJS - 2.1.2
 * http://canjs.us/
 * Copyright (c) 2014 Bitovi
 * Mon, 16 Jun 2014 20:44:30 GMT
 * Licensed MIT
 * Includes: can/map/define
 * Download from: http://canjs.com
 */

(function(e){var t=function(t){t.Map.helpers.define=function(e){var t=e.prototype.define;e.defaultGenerators={};for(var n in t)"value"in t[n]&&(typeof t[n].value=="function"?e.defaultGenerators[n]=t[n].value:e.defaults[n]=t[n].value),typeof t[n].Value=="function"&&function(t){e.defaultGenerators[n]=function(){return new t}}(t[n].Value)};var n=t.Map.prototype._setupDefaults;t.Map.prototype._setupDefaults=function(){var e=n.call(this),t=this.constructor;for(var r in t.defaultGenerators)e[r]=t.defaultGenerators[r].call(this);return e};var r=t.Map.prototype,i=r.__set;r.__set=function(n,r,s,o,u){var a=function(e){var r=u&&u.call(f,e);return r!==!1&&t.trigger(f,"error",[n,e],!0),!1},f=this,l=this.define&&this.define[n],c=l&&l.set,h=l&&l.get;if(c){t.batch.start();var p=!1,d=c.call(this,r,function(e){i.call(f,n,e,s,o,a),p=!0},a);if(h){t.batch.stop();return}if(d===e&&!p&&c.length>=2){t.batch.stop();return}return p||i.call(f,n,c.length===0&&d===e?r:d,s,o,a),t.batch.stop(),this}return i.call(f,n,r,s,o,a),this};var s={date:function(e){var t=typeof e;return t==="string"?(e=Date.parse(e),isNaN(e)?null:new Date(e)):t==="number"?new Date(e):e},number:function(e){return+e},"boolean":function(e){return e==="false"||e==="0"||!e?!1:!0},"*":function(e){return e},string:function(e){return""+e}},o=r.__type;r.__type=function(e,t){var n=this.define&&this.define[t],r=n&&n.type,i=n&&n.Type,u=e;return typeof r=="string"&&(r=s[r]),r||i?(r&&(u=r.call(this,u,t)),i&&!(u instanceof i)&&(u=new i(u)),u):o.call(this,u,t)};var u=r._remove;r._remove=function(e,n){var r=this.define&&this.define[e]&&this.define[e].remove,i;if(r){t.batch.start(),i=r.call(this,n);if(i===!1){t.batch.stop();return}return i=u.call(this,e,n),t.batch.stop(),i}return u.call(this,e,n)};var a=r._setupComputes;r._setupComputes=function(e){a.apply(this,arguments);for(var n in this.define){var r=this.define[n],i=r.get;i&&(this[n]=t.compute.async(e[n],i,this),this._computedBindings[n]={count:0})}};var f=t.Map.helpers._serialize;t.Map.helpers._serialize=function(e,t,n){return l(e,t,n)};var l=function(t,n,r){var i=t.define&&t.define[n]&&t.define[n].serialize;if(i===e)return f.apply(this,arguments);if(i!==!1)return typeof i=="function"?i.call(t,r,n):f.apply(this,arguments)},c=r.serialize;return r.serialize=function(t){var n=c.apply(this,arguments);if(t)return n;var r,i;for(var s in this.define)s in n||(r=this.define&&this.define[s]&&this.define[s].serialize,r&&(i=l(this,s,this.attr(s)),i!==e&&(n[s]=i)));return n},t.Map}(window.can,e)})();