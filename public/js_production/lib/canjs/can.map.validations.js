/*!
 * CanJS - 2.1.2
 * http://canjs.us/
 * Copyright (c) 2014 Bitovi
 * Mon, 16 Jun 2014 20:44:30 GMT
 * Licensed MIT
 * Includes: can/map/validations
 * Download from: http://canjs.com
 */

(function(e){var t=function(t){var n=function(n,r,i){i||(i=r,r={}),r=r||{},n=typeof n=="string"?[n]:t.makeArray(n);if(r.testIf&&!r.testIf.call(this))return;var s=this;t.each(n,function(t){s.validations[t]||(s.validations[t]=[]),s.validations[t].push(function(n){var s=i.call(this,n,t);return s===e?e:r.message||s})})},r=t.Map.prototype.__set;return t.Map.prototype.__set=function(e,n,i,s,o){var u=this,a=u.constructor.validations,f=function(n){var r=o&&o.call(u,n);return r!==!1&&t.trigger(u,"error",[e,n],!0),!1};r.call(u,e,n,i,s,f);if(a&&a[e]){var l=u.errors(e);l&&f(l)}return this},t.each([t.Map,t.Model],function(r){if(r===e)return;var i=r.setup;t.extend(r,{setup:function(e){i.apply(this,arguments);if(!this.validations||e.validations===this.validations)this.validations={}},validate:n,validationMessages:{format:"is invalid",inclusion:"is not a valid option (perhaps out of range)",lengthShort:"is too short",lengthLong:"is too long",presence:"can't be empty",range:"is out of range",numericality:"must be a number"},validateFormatOf:function(e,t,r){n.call(this,e,r,function(e){if(typeof e!="undefined"&&e!==null&&e!==""&&String(e).match(t)===null)return this.constructor.validationMessages.format})},validateInclusionOf:function(e,t,r){n.call(this,e,r,function(e){if(typeof e=="undefined")return;for(var n=0;n<t.length;n++)if(t[n]===e)return;return this.constructor.validationMessages.inclusion})},validateLengthOf:function(e,t,r,i){n.call(this,e,i,function(e){if((typeof e=="undefined"||e===null)&&t>0||typeof e!="undefined"&&e!==null&&e.length<t)return this.constructor.validationMessages.lengthShort+" (min="+t+")";if(typeof e!="undefined"&&e!==null&&e.length>r)return this.constructor.validationMessages.lengthLong+" (max="+r+")"})},validatePresenceOf:function(e,t){n.call(this,e,t,function(e){if(typeof e=="undefined"||e===""||e===null)return this.constructor.validationMessages.presence})},validateRangeOf:function(e,t,r,i){n.call(this,e,i,function(e){if((typeof e=="undefined"||e===null)&&t>0||typeof e!="undefined"&&e!==null&&(e<t||e>r))return this.constructor.validationMessages.range+" ["+t+","+r+"]"})},validatesNumericalityOf:function(e){n.call(this,e,function(e){var t=!isNaN(parseFloat(e))&&isFinite(e);if(!t)return this.constructor.validationMessages.numericality})}})}),t.extend(t.Map.prototype,{errors:function(e,n){e&&(e=t.isArray(e)?e:[e]);var r={},i=this,s=function(e,s){t.each(s,function(t){var s=t.call(i,u?i.__convert?i.__convert(e,n):n:i.attr(e));s&&(r[e]||(r[e]=[]),r[e].push(s))})},o=this.constructor.validations,u=e&&e.length===1&&arguments.length===2;return t.each(e||o||{},function(e,t){typeof t=="number"&&(t=e,e=o[t]),s(t,e||[])}),t.isEmptyObject(r)?null:u?r[e[0]]:r}}),t.Map}(window.can,e)})();