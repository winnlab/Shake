/*!
 * CanJS - 2.1.2
 * http://canjs.us/
 * Copyright (c) 2014 Bitovi
 * Mon, 16 Jun 2014 20:44:18 GMT
 * Licensed MIT
 * Includes: CanJS default build
 * Download from: http://canjs.us/
 */

steal("can/util","can/map",function(e){var t=function(t,n,r){r||(r=n,n={}),n=n||{},t=typeof t=="string"?[t]:e.makeArray(t);if(n.testIf&&!n.testIf.call(this))return;var i=this;e.each(t,function(e){i.validations[e]||(i.validations[e]=[]),i.validations[e].push(function(t){var i=r.call(this,t,e);return i===undefined?undefined:n.message||i})})},n=e.Map.prototype.__set;return e.Map.prototype.__set=function(t,r,i,s,o){var u=this,a=u.constructor.validations,f=function(n){var r=o&&o.call(u,n);return r!==!1&&e.trigger(u,"error",[t,n],!0),!1};n.call(u,t,r,i,s,f);if(a&&a[t]){var l=u.errors(t);l&&f(l)}return this},e.each([e.Map,e.Model],function(n){if(n===undefined)return;var r=n.setup;e.extend(n,{setup:function(e){r.apply(this,arguments);if(!this.validations||e.validations===this.validations)this.validations={}},validate:t,validationMessages:{format:"is invalid",inclusion:"is not a valid option (perhaps out of range)",lengthShort:"is too short",lengthLong:"is too long",presence:"can't be empty",range:"is out of range",numericality:"must be a number"},validateFormatOf:function(e,n,r){t.call(this,e,r,function(e){if(typeof e!="undefined"&&e!==null&&e!==""&&String(e).match(n)===null)return this.constructor.validationMessages.format})},validateInclusionOf:function(e,n,r){t.call(this,e,r,function(e){if(typeof e=="undefined")return;for(var t=0;t<n.length;t++)if(n[t]===e)return;return this.constructor.validationMessages.inclusion})},validateLengthOf:function(e,n,r,i){t.call(this,e,i,function(e){if((typeof e=="undefined"||e===null)&&n>0||typeof e!="undefined"&&e!==null&&e.length<n)return this.constructor.validationMessages.lengthShort+" (min="+n+")";if(typeof e!="undefined"&&e!==null&&e.length>r)return this.constructor.validationMessages.lengthLong+" (max="+r+")"})},validatePresenceOf:function(e,n){t.call(this,e,n,function(e){if(typeof e=="undefined"||e===""||e===null)return this.constructor.validationMessages.presence})},validateRangeOf:function(e,n,r,i){t.call(this,e,i,function(e){if((typeof e=="undefined"||e===null)&&n>0||typeof e!="undefined"&&e!==null&&(e<n||e>r))return this.constructor.validationMessages.range+" ["+n+","+r+"]"})},validatesNumericalityOf:function(e){t.call(this,e,function(e){var t=!isNaN(parseFloat(e))&&isFinite(e);if(!t)return this.constructor.validationMessages.numericality})}})}),e.extend(e.Map.prototype,{errors:function(t,n){t&&(t=e.isArray(t)?t:[t]);var r={},i=this,s=function(t,s){e.each(s,function(e){var s=e.call(i,u?i.__convert?i.__convert(t,n):n:i.attr(t));s&&(r[t]||(r[t]=[]),r[t].push(s))})},o=this.constructor.validations,u=t&&t.length===1&&arguments.length===2;return e.each(t||o||{},function(e,t){typeof t=="number"&&(t=e,e=o[t]),s(t,e||[])}),e.isEmptyObject(r)?null:u?r[t[0]]:r}}),e.Map});